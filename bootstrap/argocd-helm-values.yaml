global:
  domain: argocd.zmuda.pro
  tolerations:
    - key: "node-role.kubernetes.io/control-plane"
      operator: "Exists"
      effect: "NoSchedule"
  affinity:
    nodeAffinity:
      type: soft
      matchExpressions:
        - key: "node-role.kubernetes.io/control-plane"
          operator: "In"
          values:
            - "true"
  image:
    repository: theadzik/custom-argocd
    tag: ""

  imagePullSecrets:
    - name: dockerhub-image-pull-secret

  networkPolicy:
    create: true
    defaultDenyIngress: false

  priorityClassName: "system-cluster-critical"

configs:
  params:
    server.insecure: true
  rbac:
    policy.csv: |
      p, role:authenticated, *, *, *, deny
      g, zmuda-pro:argocd-admins, role:admin
    policy.default: role:authenticated
    scopes: '[groups, email]'
    policy.matchMode: 'glob'

server:
  ingress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: "lets-encrypt-prod"
    labels:
      dns-type: internal
    ingressClassName: "traefik"
    tls: true

repoServer:
  env:
    - name: GITCRYPT_KEY_PATH
      value: "/git-crypt/git-crypt-key"
  volumeMounts:
    - mountPath: /git-crypt
      name: git-crypt
      readOnly: true
  volumes:
    - name: git-crypt
      secret:
        secretName: git-crypt-secret
